# üö¶ Traffic-Informed Symbolic Regression (TI-SR)

This repository implements **Traffic-Informed Symbolic Regression (TI-SR)**, a traffic informed symbolic regression approach to improve model interpretability and performance.  

---

## üìå Prerequisites

Before running the code, make sure the following are installed:

- **[PySR](https://github.com/MilesCranmer/PySR)** ‚Äì Symbolic regression library for Python and Julia  
- **MATLAB** ‚Äì For traffic scenario and metric generation  
- **Julia** ‚Äì Required by PySR  

> **Note:** Replace the `SymbolicRegression.jl/src/population.jl` file in your PySR installation with the **customized `population.jl`** provided in this repository.

---

## üìÇ Repository Structure

| File | Description |
|------|-------------|
| **`TI-SR`** | Python and matlab scripts to execute and analysis the result of Traffic-Informed Symbolic Regression (TI-SR). |
| **`TI-SR/ExperimentResult`** | Predicted attack trajectories generated by TI-SR and Simple SR. |
| **`TI-SR/outputs`** | TI-SR/Simple SR output model. |
| **`TI-SR/TI-SR-Code`** | Python and Matlab scripts to execute the TI-SR based on PySR package. |
| **`DSRData`** | Predicted attack trajectories generated by DSR. |
| **`TISR/PySRResultAnalysis.m`** | Predicted attack trajectories generated by Exponential function. |

## üîÑ Workflow

### **1Ô∏è‚É£ Apply Customized setting for PySR**  
After installing the PySR, replace the 'SymbolicRegression.jl/src/population.jl' file with the customized 'population.jl' provided in the folder TI-SR/TI-SR-Code. Additional Installation may be needed for 'SymbolicRegression.jl', details instruction can be found in https://ai.damtp.cam.ac.uk/pysr/backend/.

### **2 Build the connection for matlab**  
Run the code TI-SR/TI-SR-Code/GenerateCRMatrixIDM1-4.m. This code provides the driving scenario library generation and evaluation

### **3 Implement TI-SR**  
Run the code TI-SR/TI-SR-Code/SymbolicRegressionCode.py to implement TI-SR

### **4 Result Analysis**  
Run the code "TI-SR/TI-SR-Code/ResultAnalysis/GeneratePySRTestTrajectory.py", generate predicted trajectories by TI-SR, trajectory level evaluation results and the input for traffic level evaluation.
Run the code "TI-SR/TI-SR-Code/ResultAnalysis/PySRResultAnalysis.m". generate traffic level evaluation result.



