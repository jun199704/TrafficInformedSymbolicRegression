# üö¶ Traffic-Informed Symbolic Regression (TI-SR)

This repository implements **Traffic-Informed Symbolic Regression (TI-SR)**, a traffic informed symbolic regression approach to improve model interpretability and performance.  

---

## üìå Prerequisites

Before running the code, make sure the following are installed:

- **[PySR](https://github.com/MilesCranmer/PySR)** ‚Äì Symbolic regression library for Python and Julia  
- **MATLAB** ‚Äì For traffic scenario and metric generation  
- **Julia** ‚Äì Required by PySR  

> **Note:** Replace the `SymbolicRegression.jl/src/population.jl` file in your PySR installation with the **customized `population.jl`** provided in this repository.

---

## üìÇ Repository Structure

| File | Description |
|------|-------------|
| **`TI-SR`** | Python and matlab scripts to execute and analysis the result of Traffic-Informed Symbolic Regression (TI-SR). |
| **`TI-SR/ExperimentResult`** | Predicted attack trajectories generated by TI-SR and Simple SR. |
| **`TI-SR/outputs`** | TI-SR/Simple SR output model. |
| **`TI-SR/TI-SR-Code`** | Python and Matlab scripts to execute the TI-SR based on PySR package. |
| **`DSRData`** | Predicted attack trajectories generated by DSR. |
| **`TISR/PySRResultAnalysis.m`** | Predicted attack trajectories generated by Exponential function. |

## üîÑ Workflow
### **1Ô∏è‚É£ Apply Customized Settings for PySR**  
After installing PySR, replace the file:  
-SymbolicRegression.jl/src/population.jl with the customized `population.jl` provided in: TI-SR/TI-SR-Code/.
-Additional setup may be required for `SymbolicRegression.jl`. Detailed installation instructions are available in the [PySR backend documentation](https://ai.damtp.cam.ac.uk/pysr/backend/).

### **2Ô∏è‚É£ Generate Driving Scenarios and Metrics (MATLAB)**  
-Run: TI-SR/TI-SR-Code/GenerateCRMatrixIDM1-4.m.
-This script generates the driving scenario library and computes traffic-related metrics.

### **3Ô∏è‚É£ Implement TI-SR (Python)**  
-Run: TI-SR/TI-SR-Code/SymbolicRegressionCode.py.
-This script runs the Traffic-Informed Symbolic Regression process.

### **4Ô∏è‚É£ Perform Result Analysis**  
1. **Generate Predicted Trajectories & Trajectory-Level Evaluation**  
-Run:  TI-SR/TI-SR-Code/ResultAnalysis/GeneratePySRTestTrajectory.py.
-This produces predicted trajectories using TI-SR, performs trajectory-level evaluation, and prepares inputs for traffic-level evaluation.  
2. **Traffic-Level Evaluation**  
-Run:  TI-SR/TI-SR-Code/ResultAnalysis/PySRResultAnalysis.m.
-This script calculates traffic-level evaluation metrics.

## ‚ö†Ô∏è Important Notes
- Ensure MATLAB and Python can exchange data (e.g., via `.csv` or `.mat` files).  
- PySR requires Julia to be properly installed and accessible from Python.  
- The provided `population.jl` **must replace** the default PySR version to enable the customized evolutionary process.  


